Signatures

data_formats        input     filter     stride    dilation   output[0] 
(NHC, NWHC, NDHWC)  bik       fkl        s         d          bol
(NCH, NCHW, NCDHW)  bki       fkl        s         d          blo


Index ranks

rank(b) in [0, 5]      # b = "batch"
rank(i) in [1, 3]      # i = "input spatial"
rank(o) = rank(i)      # o = "output spatial"
rank(k) = 1            # k = "input channel"
rank(l) = 1            # l = "output channel"
rank(s) = rank(i)      # s = "strides"
rank(d) = rank(i)      # d = "dilations"


Computed dimensions

o = (i - f) // s
o = i // s         (padding = SAME)


DType Rules

input.dtype in (int32, ...)
filter.dtype = input.dtype


Excluded dtype combos

input.dtype   rank(i)   layout
int32         1,2       channel_first 
int32         3         * 
bfloat16      1,2       channel_first
bfloat16      3         channel_first


